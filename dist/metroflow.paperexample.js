var MetroFlow=MetroFlow||{};MetroFlow.paperexample=function(t){function e(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=3)}([function(t,e){t.exports=paper},function(t,e,n){function o(t){return Object.create(s).Station(t)}function i(){return Object.create(l)}function r(t,e){return Object.create(c).Segment(t,e)}n(0);var a={strokeColor:"black",strokeWidth:4,fillColor:"white",stationRadius:8,selectionColor:"green",fullySelected:!0},s={Station:function(t){return console.log("new station for point",t),this.position=t,this},isSelected:!1,toggleSelect:function(){this.isSelected?this.unselect():this.select()},select:function(){this.isSelected=!0,this.circle.strokeColor=a.selectionColor},unselect:function(){this.isSelected=!1,this.circle.strokeColor=a.strokeColor},draw:function(){this.circle=new Path.Circle(this.position,a.stationRadius),this.circle.strokeColor=a.strokeColor,this.circle.strokeWidth=a.strokeWidth,this.circle.fillColor=a.fillColor,this.circle.fullySelected=a.isDebug}},l={stations:[],segments:[],draw:function(){console.log("draw track"),this.createSegments(),project.clear();for(var t in this.segments){var e=null;t>0&&(e=this.segments[t-1]),this.segments[t].draw(e)}for(var t in this.stations)this.stations[t].draw()},createSegments:function(){this.segments=[];for(var t=1;t<this.stations.length;++t){var e=this.stations[t-1],n=this.stations[t],o=r(e.position,n.position);this.segments.push(o)}},findStation:function(t){for(var e in this.stations){var n=this.stations[e].circle.id;if(console.log(n),this.stations[e].circle.id===t)return this.stations[e]}return null}},c={Segment:function(t,e){return this.begin=t,this.end=e,this},direction:function(){return this.end-this.begin},createPath:function(){var t=new Path;return t.strokeColor="red",t.strokeWidth=8,t.strokeCap="round",t.strokeJoin="round",t.fullySelected=!0,t},draw:function(t){var e=this.end-this.begin,n=Math.min(Math.abs(e.x),Math.abs(e.y))-40,o=Math.abs(e.y)-n,i=Math.abs(e.x)-n;o=Math.max(o,40),i=Math.max(i,40);var r=new Point(0,o)*Math.sign(e.y),a=new Point(i,0)*Math.sign(e.x);if(t&&Math.abs(t.direction().x)>Math.abs(t.direction().y)&&(r=new Point(i,0)*Math.sign(e.x),a=new Point(0,o)*Math.sign(e.y)),Math.abs(e.x)>60&&Math.abs(e.y)>60){var s=this.end-a,l=this.begin+r,c=l-10*r.normalize()*2,h=l-10*r.normalize(),d=l+10*(s-l).normalize(),u=l+10*(s-l).normalize()*2,f=h+(d-h)/2,g=f+(l-f)/1.7,w=this.createPath();w.add(this.begin),w.add(c);var m=s-10*(s-l).normalize()*2,P=s-10*(s-l).normalize(),S=s+10*a.normalize(),v=s+10*a.normalize()*2,C=S+(P-S)/2,b=C+(s-C)/1.7,k=this.createPath();k.add(c),k.add(h),k.add(g),k.add(d),k.add(u),k.smooth();var p=this.createPath();p.add(u),p.add(m);var y=this.createPath();y.add(m),y.add(P),y.add(b),y.add(S),y.add(v),y.smooth();var x=this.createPath();x.add(s+10*a.normalize()*2),x.add(this.end)}else{var M=this.createPath();M.add(this.begin),M.add(this.end),M.smooth()}var z=e/2+this.begin,W=new Path.Circle(z,4);W.strokeWidth=1,W.strokeColor="blue",W.fillColor="blue";var j=new Path.Circle(l,4);j.style=W.style,j.strokeColor="green",j.fillColor="green",new Path.Circle(s,4).style=j.style}};t.exports={StationStyle:a,createStation:o,createSegment:r,createTrack:i}},,function(t,e,n){function o(){var t=new Path;return t.strokeColor=l,t.strokeWidth=a,t.strokeCap="round",t.strokeJoin="round",t.fullySelected=c,t}function i(t,e){console.log("addLine");var n=new Point(t),i=new Point(e),r=o(),a=i-n,s=Math.min(a.x,a.y)-50,l=a.y-s,c=a.x-s;console.log("maxDistance",s),console.log("straightBegin",l),console.log("straightEnd",c),l=Math.max(l,50),c=Math.max(c,50);var h=a/2+n,d=n+new Point(0,l),u=i-new Point(c,0),f=new Path.Circle(h,4);if(f.strokeWidth=1,f.strokeColor="blue",f.fillColor="blue",r.add(n),a.x>50){r.add(d),r.add(u);new Path.Circle(d,4).style=f.style;new Path.Circle(u,4).style=f.style}return r.add(i),r}n(0);var r=n(1),a=6,s=1.3*a,l="red",c=!1;r.StationStyle.strokeWidth=a,r.StationStyle.stationRadius=s,project.currentStyle={strokeColor:"red",strokeWidth:a};var h=new Point(100,200),d=new Point(100,300),u=new Point(100,400),f=new Point(400,600),g=new Point(500,400);i(h,d),i(d,u),i(u,f),i(f,g);var h=r.createStation(h),d=r.createStation(d),u=r.createStation(u),f=r.createStation(f),g=r.createStation(g)}]);